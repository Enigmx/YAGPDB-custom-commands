{{/* configuration */}}
{{$forumEraseReportChannel := 1}}
{{/* end configuration */}}
{{if eq .StrippedID "ErasePostReport"}}
{{if eq $forumEraseReportChannel 1}}
{{$ao := (getChannelOrThread (reFind `\d+` $.Message.Content)).ParentID}}
{{range .Guild.Threads}}
{{if and (bitwiseAnd .Flags 2) (eq  $ao .ParentID)}}
{{$forumEraseReportChannel = .ID}}
{{break}}
{{end}}
{{end}}
{{end}}
{{$c := cslice}}
{{range $.Message.Components}}
{{$c = $c.Append .Components}}
{{end}}
{{deleteForumPost (reFind `\d+` .Message.Content)}}
{{if not (eq (len (index .Values 0)) 0)}}
{{$user := getMember (index (reFindAll `\d+` .Message.Content) 1)}}
{{sendMessage $forumEraseReportChannel (complexMessage "content" (print "<@" $user.User.ID ">") "embed" (cembed "title" "‚ùó A  moderator deleted your post" "description" (print "**__Reason:__**\n" (index $.Values 0))))}}
{{try}}
{{updateMessage (complexMessageEdit "components" $c "content" (print .Message.Content "\n\n" .User.Mention " has removed this post for the following reason:\n" (index .Values 0)) "embed" (cslice (index .Message.Embeds 0) (index .Message.Embeds 1)))}}
{{catch}}
{{editMessage nil nil (complexMessageEdit "content" (print .Message.Content "\n\n" .User.Mention " has removed this post for the following reason:\n" (index .Values 0)) "components" $c "embed" (cslice (index .Message.Embeds 0) (index .Message.Embeds 1)))}}
{{end}}
{{else}}
{{try}}
{{updateMessage (complexMessageEdit "components" $c "content" (print .Message.Content "\n\n" .User.Mention " has removed this post.") "embed" (cslice (index .Message.Embeds 0) (index .Message.Embeds 1)))}}
{{catch}}
{{editMessage nil nil (complexMessageEdit "content" (print .Message.Content "\n\n" .User.Mention " has removed this post.") "components" $c "embed" (cslice (index .Message.Embeds 0) (index .Message.Embeds 1)))}}
{{end}}
{{end}}
{{return}}
{{end}}
{{/* https://github.com/Enigmx/YAGPDB-custom-commands/tree/main/CC%3A%20Report */}}
{{/* made in chile */}}
