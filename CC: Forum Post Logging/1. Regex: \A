{{/* Configuration */}}
{{$forumLogChannel := 0}}
{{$concludedButton := false}}
{{$deleteButton := true}}
{{$renameButton := true}}
{{/* End configuration */}}

{{if and (getChannel .Channel.ParentID).IsForum (eq .Channel.ID .Message.ID)}}
{{$b := cslice}}
{{$c := 0x000000}}
{{if $concludedButton}}
{{$c = 0xFF0000}}
{{$b = $b.Append (cbutton "label" "Concluded" "custom_id" "forumConcludedLog" "emoji" (sdict "name" "‚úÖ") "style" "secondary")}}
{{end}}
{{if $deleteButton}}
{{$b = $b.Append (cbutton "label" "Erase post" "custom_id" "forumErasePostLog" "emoji" (sdict "name" "üóëÔ∏è") "style" "secondary")}}
{{end}}
{{if $renameButton}}
{{$b = $b.Append (cbutton "label" "Rename" "custom_id" "forumRenamePost" "emoji" (sdict "name" "‚úèÔ∏è") "style" "secondary")}}
{{end}}
{{$attach := ""}}
{{if .Message.Attachments}}
{{$attach = (index .Message.Attachments 0).URL}}
{{end}}
{{pinMessage .Channel.ID .Message.ID}}
{{$names := cslice}}
{{$sdicts := cslice}}
{{$count := 0}}
{{range (getChannel .Channel.ParentID).AvailableTags}}
{{$count = add $count 1}}
{{if in $.Channel.AppliedTags .ID}}
{{$sdicts = $sdicts.Append (sdict "label" .Name "default" true "value" (toString .ID))}}
{{else}}
{{$sdicts = $sdicts.Append (sdict "label" .Name "value" (toString .ID))}}
{{end}}
{{end}}
{{if eq (len $sdicts) 0}}
{{sendMessage $forumLogChannel (complexMessage "content" (print .Channel.Mention " - Post created by: " .User.Mention "\nForum: <#" .Channel.ParentID ">") "embed" (cembed "color" $c "image" (sdict "url" $attach) "title" .Channel.Name "description" .Message.Content "author" (sdict "name" ($.User.Username) "icon_url" ($.User.AvatarURL "512"))) "buttons" $b)}}
{{else}}
{{sendMessage $forumLogChannel (complexMessage "content" (print .Channel.Mention " - Post created by: " .User.Mention "\nForum: <#" .Channel.ParentID ">") "menus" (cmenu "type" "text" "placeholder" "Post tags" "custom_id" "forumTagsEdit" "options" $sdicts "max_values" (len (getChannel .Channel.ParentID).AvailableTags)) "embed" (cembed "image" (sdict "url" $attach) "color" $c "title" .Channel.Name "description" .Message.Content "author" (sdict "name" ($.User.Username) "icon_url" ($.User.AvatarURL "512"))) "buttons" $b)}}
{{end}}
{{end}}
